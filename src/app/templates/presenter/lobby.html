<!DOCTYPE html>
<html>
    {% include 'presenter/head.html' %}
    
    <body>
        <div id="bg-image"></div>

        <div id="menu-wrapper">
            {% include 'logo.html' %}
            <h2>{{ title }}</h2>

            {% if lan_mode %}
            <div id="menu-lobby-url">
                Skriv <span id="menu-join-command">!jeopardy</span> i <strong>CoreNibbas</strong> for at joine!
            </div>
            {% else %}
            <div id="menu-lobby-url">
                <div>Go to:</div>
                <span id="menu-join-url">{{ join_url }}</span>
                <div>{% if password %} and provide the password{% endif %} to join!</div>
            </div>
            {% endif %}

            <h3>Contestants</h3>
            <div id="menu-contestants">
                {% if not game_contestants %}
                <p id="menu-no-contestants-placeholder">None yet...</p>
                {% endif %}
            </div>

            {% if lan_mode %}
            <img id="menu-naafiri" src="{{ url_for('static', _external=True, filename='img/naafiri_dance.gif') }}">
            <img id="menu-alistar" src="{{ url_for('static', _external=True, filename='img/alistar_dance.gif') }}">
            <img id="menu-teemo" src="{{ url_for('static', _external=True, filename='img/teemo_dance.gif') }}">
            <img id="menu-ivern" src="{{ url_for('static', _external=True, filename='img/ivern_dance.gif') }}">
            <img id="menu-brand" src="{{ url_for('static', _external=True, filename='img/brand_dance.gif') }}">
            <img id="menu-nidalee" src="{{ url_for('static', _external=True, filename='img/nidalee_dance.gif') }}">
            <img id="menu-quinn" src="{{ url_for('static', _external=True, filename='img/quinn_thonk.gif') }}">
            <img id="menu-vi" src="{{ url_for('static', _external=True, filename='img/vi_point.gif') }}">
            {% endif %}
        </div>

        {% if lobby_music %}
        <audio id="menu-lobby-music" loop>
            <source src="{{ url_for('static', _external=True, filename=lobby_music) }}" type="audio/mpeg">
        </audio>
        {% endif %}
    </body>

    <script>
        socket.on("connect", function() {
            socket.emit("presenter_joined");
            socket.on("player_joined", addPlayerDiv);
        });

        {% for contestant in game_contestants %}
        addPlayerDiv("{{ contestant['contestant_id'] }}", "{{ contestant['contestant']['name'] }}", "{{ contestant['contestant']['avatar'] }}", "{{ contestant['contestant']['color'] }}");
        {% endfor %}

        window.onkeydown = function(e) {
            if (e.code == PRESENTER_ACTION_KEY) {
                let audio = document.getElementById("menu-lobby-music");
                if (audio != null) {
                    audio.volume = 0.1;
                    audio.play();

                    setTimeout(function() {
                        window.onkeydown = function(e) {
                            if (e.code == PRESENTER_ACTION_KEY) {
                                beginJeopardy();
                            }
                        }
                    }, 1000);
                }
                else {
                    beginJeopardy();
                }
            }
        }
    </script>
</html>